<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard - lukumisteress</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #fce7f3 0%, #fff1f2 50%, #ffffff 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #ec4899, #f472b6);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #db2777, #ec4899);
    }

    /* Glassmorphism Effect */
    .glass {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(236, 72, 153, 0.1);
    }

    .glass-strong {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      border: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 12px 40px rgba(236, 72, 153, 0.15);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse-glow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(236, 72, 153, 0.3);
      }
      50% {
        box-shadow: 0 0 30px rgba(236, 72, 153, 0.6);
      }
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .fade-in {
      animation: fadeInUp 0.6s ease-out forwards;
    }

    .stat-card {
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(236, 72, 153, 0.2);
    }

    .order-card {
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
    }

    .order-card:hover {
      transform: translateX(5px);
      border-left-color: #ec4899;
      box-shadow: 0 10px 30px rgba(236, 72, 153, 0.15);
    }

    /* Gradient Text */
    .gradient-text {
      background: linear-gradient(135deg, #ec4899, #f472b6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Button Styles */
    .btn-gradient {
      background: linear-gradient(135deg, #ec4899, #f472b6);
      transition: all 0.3s ease;
    }

    .btn-gradient:hover {
      background: linear-gradient(135deg, #db2777, #ec4899);
      box-shadow: 0 8px 20px rgba(236, 72, 153, 0.4);
      transform: translateY(-2px);
    }

    /* Loading Spinner */
    .spinner {
      border: 3px solid rgba(236, 72, 153, 0.1);
      border-top: 3px solid #ec4899;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    /* Sidebar Active State */
    .nav-btn {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: linear-gradient(135deg, #ec4899, #f472b6);
      transform: scaleY(0);
      transition: transform 0.3s ease;
    }

    .nav-btn:hover::before,
    .nav-btn.active::before {
      transform: scaleY(1);
    }

    .nav-btn:hover {
      background: rgba(236, 72, 153, 0.1);
      padding-left: 1.5rem;
    }

    /* Chart Container */
    .chart-container {
      position: relative;
      height: 400px;
    }

    @media (max-width: 768px) {
      .chart-container {
        height: 300px;
      }
    }

    /* Modal Backdrop */
    .modal-backdrop {
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    /* Badge Styles */
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .badge:hover {
      transform: scale(1.05);
    }

    /* Product Card */
    .product-card {
      transition: all 0.3s ease;
    }

    .product-card:hover {
      transform: scale(1.02);
      box-shadow: 0 10px 30px rgba(236, 72, 153, 0.15);
    }

    /* Input Focus */
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #ec4899;
      box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1);
    }

    /* Sidebar Overlay */
    .sidebar-overlay {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
    }

    /* Hover Effects */
    .hover-lift {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .hover-lift:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(236, 72, 153, 0.2);
    }
  </style>
</head>

<body>

<!-- üîê Login Modal -->
<div id="loginModal" class="fixed inset-0 bg-black bg-opacity-60 modal-backdrop flex items-center justify-center z-50">
  <div class="glass-strong rounded-2xl shadow-2xl p-8 w-full max-w-md space-y-6 fade-in">
    <div class="text-center">
      <h2 class="text-3xl font-bold gradient-text mb-2">Admin Login</h2>
      <p class="text-gray-600 text-sm">Access your admin dashboard</p>
    </div>

    <form id="admin-login-form" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
        <input type="email" id="adminEmail" placeholder="admin@lukumisteress.com" required
          class="w-full px-4 py-3 bg-white border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 transition" />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
        <input type="password" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
          class="w-full px-4 py-3 bg-white border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 transition" />
      </div>

      <button type="submit" id="login-btn"
        class="w-full btn-gradient text-white py-3 rounded-xl font-semibold shadow-lg">
        Login to Dashboard
      </button>

      <p id="loginStatus" class="text-center text-sm text-red-500 font-medium"></p>
    </form>
  </div>
</div>

<div class="flex min-h-screen">
  <!-- Sidebar -->
  <aside id="sidebar" class="fixed inset-y-0 left-0 z-50 w-72 glass-strong transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out shadow-2xl">
    <div class="flex flex-col h-full p-6">
      <!-- Logo -->
      <div class="mb-8">
        <h2 class="text-3xl font-bold gradient-text mb-2">luku misteress</h2>
        <p class="text-sm text-gray-500">Admin Dashboard</p>
      </div>

      <!-- Navigation -->
      <nav class="flex-1 space-y-2">
        <button onclick="showSectionAndHideSidebar('analytics')" class="nav-btn active w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 flex items-center gap-3">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
        </svg>
        Analytics
      </button>

        <button onclick="showSectionAndHideSidebar('orders')" class="nav-btn w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
          </svg>
          Orders
        </button>
        <button onclick="showSectionAndHideSidebar('coupons')" class="nav-btn w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
          </svg>
          Coupons
        </button>
        <button onclick="showSectionAndHideSidebar('users')" class="nav-btn w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
          Users
        </button>
        <button onclick="window.location.href='https://lukumisteress.iyonicorp.com'; hideSidebar();" class="nav-btn w-full text-left px-4 py-3 rounded-lg font-medium text-gray-700 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 flex items-center gap-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
          Visit Shop
        </button>
      </nav>

      <!-- Logout Button -->
      <button onclick="logoutAdmin()" class="w-full px-4 py-3 rounded-lg font-medium text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
        </svg>
        Logout
      </button>
    </div>
  </aside>

  <!-- Sidebar Overlay (Mobile) -->
  <div id="sidebar-overlay" class="fixed inset-0 sidebar-overlay z-40 hidden md:hidden" onclick="hideSidebar()"></div>

  <!-- Hamburger Menu (Mobile) -->
  <button id="hamburger-btn" class="fixed top-6 right-6 z-50 md:hidden glass-strong rounded-full p-3 shadow-lg hover:shadow-xl" aria-label="Open Menu">
    <svg class="w-6 h-6 text-pink-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
    </svg>
  </button>

  <!-- Main Content -->
  <main class="flex-1 md:ml-72 p-4 sm:p-6 lg:p-8">
    <div class="max-w-7xl mx-auto space-y-8">
    
    <!-- Analytics Section -->
    <section id="analytics" class="fade-in">
      <div class="flex flex-col lg:flex-row lg:items-center justify-between mb-8 gap-4">
        <div>
          <h2 class="text-4xl font-bold text-gray-800 mb-2">Analytics Dashboard</h2>
          <p class="text-gray-600">Monitor your store performance</p>
        </div>
        <select id="orderTimeFilter" class="glass px-4 py-3 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500 text-sm font-medium cursor-pointer" onchange="fetchAdminAnalytics()">
          <option value="all">All Time</option>
          <option value="today">Today</option>
          <option value="week">This Week</option>
          <option value="month">This Month</option>
          <option value="year">This Year</option>
        </select>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <div class="glass stat-card rounded-2xl p-6 hover-lift shadow-xl">
          <div class="flex items-center justify-between mb-4">
            <div class="p-3 bg-gradient-to-br from-green-400 to-green-600 rounded-xl shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
          </div>
          <h2 class="text-sm font-medium text-gray-600 mb-1">Total Sales</h2>
          <p class="text-4xl font-bold text-gray-800">Ksh <span id="totalRevenue">0</span></p>
          <p class="text-xs text-gray-500 mt-2">Revenue generated</p>
        </div>

        <div class="glass stat-card rounded-2xl p-6 hover-lift shadow-xl">
          <div class="flex items-center justify-between mb-4">
            <div class="p-3 bg-gradient-to-br from-pink-400 to-pink-600 rounded-xl shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
              </svg>
            </div>
          </div>
          <h2 class="text-sm font-medium text-gray-600 mb-1">Most Bought Product</h2>
          <p class="text-lg font-bold text-gray-800"><span id="topProduct">-</span></p>
          <p class="text-xs text-gray-500 mt-2">Best seller</p>
        </div>

        <div class="glass stat-card rounded-2xl p-6 hover-lift shadow-xl">
          <div class="flex items-center justify-between mb-4">
            <div class="p-3 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl shadow-lg">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
              </svg>
            </div>
          </div>
          <h2 class="text-sm font-medium text-gray-600 mb-1">Top Buyer</h2>
          <p class="text-lg font-bold text-gray-800"><span id="topUser">-</span></p>
          <p class="text-xs text-gray-500 mt-2">Most orders placed</p>
        </div>
      </div>

      <div class="glass rounded-2xl p-6 lg:p-8 mb-8 hover-lift shadow-xl">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h3 class="text-xl lg:text-2xl font-bold text-gray-800">üìä Purchase Timeline</h3>
            <p class="text-sm text-gray-500 mt-1">Track sales over time</p>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="salesChart"></canvas>
        </div>
      </div>

      <div class="glass rounded-2xl p-6 lg:p-8 hover-lift shadow-xl">
        <h3 class="text-xl lg:text-2xl font-bold text-gray-800 mb-6">üì¶ Products Sold</h3>
        <div id="productInventory" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
      </div>
    </section>

    <!-- Orders Section -->
    <section id="orders" class="hidden fade-in">
      <div class="mb-8">
        <h2 class="text-4xl font-bold text-gray-800 mb-2">Order Management</h2>
        <p class="text-gray-600">View and manage customer orders</p>
      </div>
      <div id="statusButtons" class="flex gap-3 mb-6 flex-wrap"></div>
      <div id="ordersOutput" class="space-y-4"></div>
    </section>

    <!-- Coupons Section -->
    <section id="coupons" class="hidden fade-in">
      <div class="mb-8">
        <h2 class="text-4xl font-bold text-gray-800 mb-2">Coupon Management</h2>
        <p class="text-gray-600">Create and manage discount coupons</p>
      </div>
      
      <div class="glass rounded-2xl p-8 mb-6">
        <h3 class="text-xl font-bold text-gray-800 mb-6">Create New Coupon</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Coupon Code</label>
            <input type="text" id="couponCode" placeholder="e.g., SUMMER2024" 
              class="w-full px-4 py-3 bg-white border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Discount Amount (Ksh)</label>
            <input type="number" id="couponAmount" placeholder="e.g., 500" 
              class="w-full px-4 py-3 bg-white border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500" />
          </div>
        </div>
        <button onclick="createCoupon()" class="mt-4 btn-gradient text-white px-6 py-3 rounded-xl font-semibold shadow-lg">
          Create Coupon
        </button>
      </div>

      <div id="couponsOutput" class="space-y-4"></div>
    </section>

    <!-- Users Section -->
    <section id="users" class="hidden fade-in">
      <div class="mb-8">
        <h2 class="text-4xl font-bold text-gray-800 mb-2">User Management</h2>
        <p class="text-gray-600">View and manage registered users</p>
      </div>

      <div class="glass rounded-2xl p-4 mb-6">
        <input
          type="text"
          id="userSearchInput"
          placeholder="üîç Search by name or email..."
          class="w-full px-4 py-3 bg-white border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-500"
          oninput="filterUsers()"
        />
      </div>

      <div id="usersOutput" class="space-y-4"></div>

      <!-- User Details Modal -->
      <div id="userDetailsModal" class="fixed inset-0 bg-black bg-opacity-60 modal-backdrop hidden items-center justify-center z-50 flex">
        <div id="userDetailsBox" class="glass-strong w-full max-w-4xl p-8 rounded-2xl shadow-2xl overflow-y-auto max-h-[90vh]">
          <div id="userDetailsContent"></div>
          <div class="flex justify-end mt-8">
            <button onclick="closeUserDetails()" class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-6 py-3 rounded-xl font-semibold shadow-lg transition">
              Close
            </button>
          </div>
        </div>
      </div>
    </section>

    </div>
  </main>
</div>

<!-- üíª JavaScript -->
<script>
  let token = '';
  let allUsers = [];

  // Sidebar functions
  function showSidebar() {
    document.getElementById('sidebar').classList.remove('-translate-x-full');
    document.getElementById('sidebar-overlay').classList.remove('hidden');
  }

  function hideSidebar() {
    document.getElementById('sidebar').classList.add('-translate-x-full');
    document.getElementById('sidebar-overlay').classList.add('hidden');
  }

  function showSectionAndHideSidebar(id) {
    showSection(id);
    hideSidebar();
  }

  // Hamburger menu
  document.getElementById('hamburger-btn').addEventListener('click', showSidebar);

  function showSection(id) {
    document.querySelectorAll('main section').forEach(sec => sec.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');

    // Update active nav button
    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    event.target.closest('.nav-btn')?.classList.add('active');
    
    switch (id) {
      case 'orders': fetchOrders(); break;
      case 'coupons': fetchCoupons(); break;
      case 'users': fetchUsers(); break;
      case 'analytics': fetchAdminAnalytics(); break;
    }
  }

  // Legacy function for compatibility
  function handleNav(id) {
    showSection(id);
  }

document.getElementById('admin-login-form').addEventListener('submit', async function (e) {
  e.preventDefault();

  const button = document.getElementById('login-btn');
  const originalText = button.textContent;

  button.disabled = true;
  button.innerHTML = '<div class="spinner mx-auto"></div>';

  const email = document.getElementById('adminEmail').value.trim();
  const password = document.getElementById('adminPassword').value;

  try {
    const res = await fetch('https://lukumisteress.onrender.com/api/admin/login',  {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();

    if (res.ok) {
      token = data.token;
      localStorage.setItem('adminToken', token);
      localStorage.setItem('adminTokenExpiry', Date.now() + 2 * 60 * 60 * 1000);

      document.getElementById('loginModal').classList.add('hidden');
      fetchAdminAnalytics();

      setTimeout(logoutAdmin, 2 * 60 * 60 * 1000);
    } else {
      document.getElementById('loginStatus').textContent = data.message || 'Invalid credentials';
    }
  } catch (err) {
    console.error("Login Error:", err);
    document.getElementById('loginStatus').textContent = 'Something went wrong.';
  } finally {
    button.disabled = false;
    button.textContent = originalText;
  }
});

function logoutAdmin() {
  token = '';
  localStorage.removeItem('adminToken');
  localStorage.removeItem('adminTokenExpiry');
  alert('Session expired. You have been logged out.');
  document.getElementById('loginModal').classList.remove('hidden');
}

window.addEventListener('DOMContentLoaded', () => {
  const savedToken = localStorage.getItem('adminToken');
  const expiry = localStorage.getItem('adminTokenExpiry');

  if (savedToken && expiry && Date.now() < parseInt(expiry)) {
    token = savedToken;
    document.getElementById('loginModal').classList.add('hidden');
    fetchAdminAnalytics();

    const remaining = parseInt(expiry) - Date.now();
    setTimeout(logoutAdmin, remaining);
  }
});

async function fetchOrders() {
  try {
    const res = await fetch('https://lukumisteress.onrender.com/api/admin/orders', {
      headers: { Authorization: 'Bearer ' + token }
    });

    const contentType = res.headers.get("content-type");
    if (!res.ok || !contentType.includes("application/json")) {
      throw new Error(await res.text());
    }

    const orders = await res.json();
    const container = document.getElementById('ordersOutput');
    const tabs = document.getElementById('statusButtons');
    container.innerHTML = '';
    tabs.innerHTML = '';

    const statusCounts = orders.reduce((acc, o) => {
      acc[o.status] = (acc[o.status] || 0) + 1;
      return acc;
    }, {});

    const allStatuses = ['All', 'Pending', 'Confirmed', 'Ready for Shipping', 'Shipped', 'Delivered', 'Cancelled'];

    allStatuses.forEach(status => {
      const count = status === 'All' ? orders.length : statusCounts[status] || 0;

      const btn = document.createElement('button');
      btn.textContent = `${status} (${count})`;
      btn.className = 'badge glass hover:bg-pink-100 text-gray-700 border border-pink-200';
      btn.onclick = () => renderOrders(status === 'All' ? orders : orders.filter(o => o.status === status));
      tabs.appendChild(btn);
    });

    renderOrders(orders);

  } catch (err) {
    console.error("Fetch Orders Error:", err);
    document.getElementById('ordersOutput').innerHTML = `<div class="glass rounded-2xl p-8 text-center"><p class="text-red-500 font-medium">Failed to load orders.</p></div>`;
  }
}

function renderOrders(orderList) {
  const container = document.getElementById('ordersOutput');
  container.innerHTML = '';

  if (!orderList.length) {
    container.innerHTML = `<div class="glass rounded-2xl p-8 text-center"><p class="text-gray-500 italic">No orders found for this status.</p></div>`;
    return;
  }

  orderList.forEach(order => {
    const div = document.createElement('div');
    div.className = 'glass order-card rounded-2xl p-6 space-y-4';

    const itemsHTML = order.items.map(item => {
      const name = item.name || 'Product';
      const price = item.price || 0;
      const quantity = item.quantity || 1;
      const size = item.size || 'N/A';
      const color = item.color || 'N/A';
      const image = item.image
        ? `<img src="${item.image}" class="w-24 h-24 object-contain rounded-xl border border-pink-200 shadow-sm" alt="${name}" />`
        : '';

      return `
        <div class="flex gap-4 items-start pb-4 border-b border-pink-100">
          ${image}
          <div class="flex-1">
            <p class="font-semibold text-gray-800 text-lg">${name}</p>
            <p class="text-sm text-gray-600 mt-1">Size: <span class="font-medium">${size}</span>, Color: <span class="font-medium">${color}</span></p>
            <p class="text-sm text-gray-700 mt-1">Quantity: <span class="font-semibold">${quantity}</span> √ó Ksh${price.toFixed(2)}</p>
          </div>
        </div>
      `;
    }).join('');

    const addr = order.deliveryAddress || {};
    const delivery = `
      <div class="bg-pink-50 rounded-xl p-4 space-y-2">
        <h4 class="font-semibold text-gray-800 mb-3">Delivery Information</h4>
        <p class="text-sm"><strong>Recipient:</strong> ${addr.name || '-'}</p>
        <p class="text-sm"><strong>Phone:</strong> ${addr.phone || '-'}</p>
        <p class="text-sm"><strong>Email:</strong> ${addr.email || '-'}</p>
        <p class="text-sm"><strong>Address:</strong> ${addr.address || '-'}, ${addr.city || '-'}, ${addr.state || '-'}, ${addr.zip || '-'}</p>
        <p class="text-sm"><strong>Country:</strong> ${addr.country || '-'}</p>
      </div>
    `;

    const statusOptions = ['Pending', 'Confirmed', 'Ready for Shipping', 'Shipped', 'Delivered', 'Cancelled']
      .map(opt => `<option value="${opt}" ${order.status === opt ? 'selected' : ''}>${opt}</option>`)
      .join('');

    const statusDropdown = `
      <div class="mt-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">Update Order Status:</label>
        <select class="glass px-4 py-2 rounded-xl border border-pink-200 focus:outline-none focus:ring-2 focus:ring-pink-500 cursor-pointer" onchange="updateOrderStatus('${order.id}', this.value)">
          ${statusOptions}
        </select>
      </div>
    `;

    const couponHTML = order.coupon
      ? `<p class="text-sm text-green-700 font-medium">üéüÔ∏è Coupon Applied: <strong>${order.coupon}</strong></p>`
      : '';

    const discountHTML = order.discount > 0
      ? `<p class="text-sm text-red-500 font-medium">üí∏ Discount: ‚àíKsh${order.discount.toFixed(2)}</p>`
      : '';

    const shippingHTML = order.shippingFee > 0
      ? `<p class="text-sm text-blue-600 font-medium">üöö Shipping Fee: Ksh${order.shippingFee.toFixed(2)}</p>`
      : '';

    const totalPrice = order.totalPrice?.toFixed(2) || '0.00';

    const paymentRefHTML = order.paymentRef
      ? `<p class="text-sm text-gray-600">üí≥ Paystack Ref: <code class="bg-gray-100 px-2 py-1 rounded">${order.paymentRef}</code></p>`
      : '';

    const paidBadge = (order.status === 'Delivered' && order.isFullyPaid)
      ? `<span class="badge bg-green-100 text-green-700 ml-2">‚úî Fully Paid</span>`
      : (order.status === 'Delivered' && !order.isFullyPaid)
        ? `<span class="badge bg-red-100 text-red-700 ml-2">‚ö†Ô∏è Not Fully Paid</span>`
        : '';

    const paymentSummary = `
      <div class="bg-blue-50 rounded-xl p-4 space-y-2">
        <h4 class="font-semibold text-gray-800 mb-3">Payment Details</h4>
        <p class="text-sm">
          <strong>Payment Method:</strong>
          <span class="${order.paymentMethod === 'pay-on-delivery' ? 'text-yellow-600' : 'text-green-700'} font-medium">
            ${order.paymentMethod === 'pay-on-delivery' ? 'Pay on Delivery' : 'Paid Online'}
          </span>
        </p>
        <p class="text-sm ${order.isDeliveryFeePaid ? 'text-green-700' : 'text-red-600'} font-medium">
          ‚úî Delivery Fee Paid: ${order.isDeliveryFeePaid ? 'Yes' : 'No'}
        </p>
        <p class="text-sm ${order.isFullyPaid ? 'text-green-700' : 'text-orange-600'} font-medium">
          üí∞ Fully Paid: ${order.isFullyPaid ? 'Yes' : 'No (Collect on delivery)'}
        </p>
      </div>
    `;

    div.innerHTML = `
      <div class="flex items-start justify-between mb-4">
        <div>
          <p class="text-lg font-semibold text-gray-800">${order.user.name}</p>
          <p class="text-sm text-gray-600">${order.user.email}</p>
        </div>
        ${paidBadge}
      </div>
      ${delivery}
      ${statusDropdown}
      <div class="space-y-2 mt-4">
        ${couponHTML}
        ${discountHTML}
        ${shippingHTML}
        <p class="text-lg font-bold text-gray-800">Total Paid: Ksh${totalPrice}</p>
        ${paymentRefHTML}
      </div>
      ${paymentSummary}
      <div class="space-y-4 mt-4">${itemsHTML}</div>
      <p class="text-sm text-gray-500 mt-4">üïí Ordered on: ${new Date(order.createdAt).toLocaleString()}</p>
    `;

    container.appendChild(div);
  });
}

async function updateOrderStatus(orderId, newStatus) {
  try {
    const res = await fetch(`https://lukumisteress.onrender.com/api/admin/orders/${orderId}/status`, {
      method: 'PATCH',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${token}`
      },
      body: JSON.stringify({ status: newStatus })
    });

    const data = await res.json();

    if (res.ok) {
      let msg = `‚úÖ Order status updated to "${data.status}"`;
      if (data.status === 'Delivered' && data.isFullyPaid) {
        msg += ` and marked as Fully Paid ‚úÖ`;
      }
      alert(msg);
      fetchOrders();
    } else {
      alert("‚ö†Ô∏è Failed to update status: " + data.message);
    }
  } catch (err) {
    console.error("Update Error:", err);
    alert("‚ùå Server error while updating status.");
  }
}

async function fetchCoupons() {
  const res = await fetch('https://lukumisteress.onrender.com/api/admin/coupons', {
    headers: { Authorization: 'Bearer ' + token }
  });
  const coupons = await res.json();
  const container = document.getElementById('couponsOutput');
  container.innerHTML = '';

  if (!coupons.length) {
    container.innerHTML = `<div class="glass rounded-2xl p-8 text-center"><p class="text-gray-500 italic">No coupons created yet.</p></div>`;
    return;
  }

  coupons.forEach(coupon => {
    const div = document.createElement('div');
    div.className = 'glass rounded-2xl p-6 flex justify-between items-center hover:shadow-lg transition';
    div.innerHTML = `
      <div>
        <p class="text-lg font-bold text-gray-800">${coupon.code}</p>
        <p class="text-sm text-gray-600 mt-1">Discount: <span class="font-semibold text-pink-600">Ksh${coupon.amount}</span></p>
      </div>
      <button onclick="deleteCoupon('${coupon._id}')" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl font-medium transition shadow">
        Delete
      </button>
    `;
    container.appendChild(div);
  });
}

async function createCoupon() {
  const code = document.getElementById('couponCode').value.trim();
  const amount = parseFloat(document.getElementById('couponAmount').value);

  if (!code || !amount || amount <= 0) {
    alert('Please enter valid coupon code and amount.');
    return;
  }

  const res = await fetch('https://lukumisteress.onrender.com/api/admin/coupons', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      Authorization: 'Bearer ' + token
    },
    body: JSON.stringify({ code, amount })
  });

  const data = await res.json();
  alert(data.message || 'Coupon created');
  
  document.getElementById('couponCode').value = '';
  document.getElementById('couponAmount').value = '';
  
  fetchCoupons();
}

async function deleteCoupon(id) {
  if (!confirm('Are you sure you want to delete this coupon?')) return;

  const res = await fetch(`https://lukumisteress.onrender.com/api/admin/coupons/${id}`, {
    method: 'DELETE',
    headers: { Authorization: 'Bearer ' + token }
  });

  const data = await res.json();
  alert(data.message || 'Deleted');
  fetchCoupons();
}

async function fetchUsers() {
  const res = await fetch('https://lukumisteress.onrender.com/api/admin/users', {
    headers: { Authorization: 'Bearer ' + token }
  });
  const users = await res.json();
  allUsers = users;

  renderUsers(users);
}

function renderUsers(users) {
  const container = document.getElementById("usersOutput");
  container.innerHTML = "";

  if (!users.length) {
    container.innerHTML = `<div class="glass rounded-2xl p-8 text-center"><p class="text-gray-500 italic">No matching users found.</p></div>`;
    return;
  }

  users.forEach(user => {
    const div = document.createElement("div");
    div.className = "glass rounded-2xl p-6 hover:shadow-lg transition";
    div.innerHTML = `
      <div class="flex items-center justify-between">
        <div>
          <p class="text-lg font-bold text-gray-800">${user.name}</p>
          <p class="text-sm text-gray-600 mt-1">${user.email}</p>
        </div>
        <button onclick="showUserDetails('${user._id}')" class="btn-gradient text-white px-4 py-2 rounded-xl font-medium shadow">
          View Details
        </button>
      </div>
    `;
    container.appendChild(div);
  });
}

async function showUserDetails(userId) {
  const res = await fetch(`https://lukumisteress.onrender.com/api/admin/users/${userId}/details`, {
    headers: { Authorization: 'Bearer ' + token }
  });

  const data = await res.json();
  const { user, orders, totalSpent } = data;
  const modal = document.getElementById('userDetailsModal');
  const content = document.getElementById('userDetailsContent');

  let ordersHTML = orders.map(order => {
    const images = order.items.map(i =>
      `<div class="flex flex-col items-center text-center">
        <img src="${i.image}" class="w-24 h-24 object-cover rounded-xl border border-pink-200 shadow-sm" title="${i.name}" />
        <p class="text-xs mt-2 text-gray-600 truncate w-24 font-medium">${i.name}</p>
      </div>`
    ).join('');

    return `
      <div class="glass rounded-xl p-6 mb-4">
        <p class="text-sm text-gray-500 mb-2">üïí ${new Date(order.createdAt).toLocaleString()}</p>
        <p class="text-lg font-semibold text-gray-800 mb-4">Total: Ksh${order.totalPrice?.toFixed(2)}</p>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
          ${images}
        </div>
      </div>
    `;
  }).join('');

  content.innerHTML = `
    <div class="mb-6">
      <h2 class="text-3xl font-bold text-gray-800 mb-2">${user.name}</h2>
      <p class="text-gray-600">${user.email}</p>
      <p class="mt-4 text-2xl font-bold text-green-600">üí∞ Total Spent: Ksh${totalSpent.toFixed(2)}</p>
    </div>
    <div>
      <h3 class="text-xl font-bold text-gray-800 mb-4">üì¶ Order History (${orders.length})</h3>
      ${ordersHTML || `<div class="glass rounded-xl p-8 text-center"><p class="text-gray-500 italic">No orders yet.</p></div>`}
    </div>
  `;

  modal.classList.remove('hidden');

  function outsideClickListener(e) {
    const box = document.getElementById("userDetailsBox");
    if (!box.contains(e.target)) {
      closeUserDetails();
    }
  }

  setTimeout(() => {
    document.addEventListener('click', outsideClickListener);
    modal.dataset.listenerAttached = 'true';
  }, 0);

  modal.dataset.cleanup = () => document.removeEventListener('click', outsideClickListener);
}

function closeUserDetails() {
  const modal = document.getElementById('userDetailsModal');
  modal.classList.add('hidden');

  if (modal.dataset.cleanup) {
    const cleanup = modal.dataset.cleanup;
    if (typeof cleanup === 'function') cleanup();
    else eval(cleanup);
    delete modal.dataset.cleanup;
  }
}

let productStock = {
  "CloudStep Pro": 20,
  "Retro Runner X": 15,
  "Brave Trail Boots": 12,
  "Perfect Pump": 30,
  "Summer Slide": 10,
  "Weekend Wedge": 25,
  "Highline Stiletto": 30,
  "Air Zoom Alpha": 18,
  "Sunny Day Sandal": 22,
  "Cozy Home Slipper": 50,
  "Urban Explorer Boot": 14,
  "Glam Night Heel": 5,
  "Windy Wedge": 16,
  "Glamour Up Sandal": 9,
  "Selena Block Pump": 11,
  "Velocity Runner": 17,
  "Crystal Chic Heel": 6,
  "Breeze Comfort Sandal": 13,
  "Mountain Trek Boot": 7,
  "Urban Slide": 19,
  "Sunset Wedge": 21,
  "Classic Pointed Pump": 23,
  "Plush Dream Slipper": 24,
  "Street Flex Sneaker": 28,
  "Velvet Touch Heel": 22,
  "Chelsea Classic Boot": 3,
  "Urban Strap Sandal": 2,
  "Comfy Foam Slide": 11,
  "Tropical Wedge": 9,
  "Evening Shine Pump": 8,
  "Winter Warm Slipper": 6,
  "Urban Pulse Sneaker": 10,
  "Midnight Velvet Heel": 5,
  "Ridge Walker Boot": 12,
  "Seaside Strap Sandal": 14
};

function updateProductInventory(productName) {
  const newQty = prompt(`Enter new inventory for "${productName}"`, productStock[productName] || 0);
  const parsed = parseInt(newQty);
  if (!isNaN(parsed) && parsed >= 0) {
    productStock[productName] = parsed;
    alert(`‚úÖ Inventory for "${productName}" updated to ${parsed}`);
    fetchAdminAnalytics();
  } else {
    alert("‚ö†Ô∏è Invalid quantity.");
  }
}

async function fetchAdminAnalytics() {
  try {
    const res = await fetch('https://lukumisteress.onrender.com/api/admin/orders', {
      headers: { Authorization: 'Bearer ' + token }
    });

    const orders = await res.json();
    if (!Array.isArray(orders)) throw new Error("Invalid orders data");

    const filter = document.getElementById('orderTimeFilter')?.value || 'all';
    const now = new Date();

    const filteredOrders = orders.filter(order => {
      const date = new Date(order.createdAt);
      if (filter === 'today') return date.toDateString() === now.toDateString();
      if (filter === 'week') {
        const weekStart = new Date(now); weekStart.setDate(now.getDate() - 7);
        return date >= weekStart && date <= now;
      }
      if (filter === 'month') return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();
      if (filter === 'year') return date.getFullYear() === now.getFullYear();
      return true;
    });

    let totalSales = 0;
    const productCount = {};
    const userSpend = {};
    const chartLabels = [];
    const chartData = [];
    const chartInfo = [];

    filteredOrders.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));

    filteredOrders.forEach(order => {
      const price = order.totalPrice || 0;
      totalSales += price;

      const userEmail = order.user?.email || 'Unknown';
      userSpend[userEmail] = (userSpend[userEmail] || 0) + price;

      order.items.forEach(item => {
        const itemName = item.name || 'Unnamed Product';
        const qty = parseInt(item.quantity) || 1;
        productCount[itemName] = (productCount[itemName] || 0) + qty;
      });

      const time = new Date(order.createdAt).toLocaleString('en-US', {
        weekday: 'short', hour: '2-digit', minute: '2-digit'
      });

      chartLabels.push(time);
      chartData.push(price);
      chartInfo.push({
        name: order.items?.[0]?.name || 'Product',
        image: order.items?.[0]?.image || '',
        price
      });
    });

    const mostBought = Object.entries(productCount).sort((a, b) => b[1] - a[1])[0];
    const topUser = Object.entries(userSpend).sort((a, b) => b[1] - a[1])[0];

    document.getElementById('totalRevenue').textContent = totalSales.toFixed(2);
    document.getElementById('topProduct').textContent = mostBought ? `${mostBought[0]} (${mostBought[1]})` : '-';
    document.getElementById('topUser').textContent = topUser ? `${topUser[0]} (Ksh${topUser[1].toFixed(2)})` : '-';

    const productInventory = {};
    orders.forEach(order => {
      order.items.forEach(item => {
        const name = item.name || 'Unnamed Product';
        const qty = parseInt(item.quantity) || 0;
        if (!productInventory[name]) {
          productInventory[name] = { quantity: 0, image: item.image || '' };
        }
        productInventory[name].quantity += qty;
      });
    });

    const inventoryContainer = document.getElementById('productInventory');
    inventoryContainer.innerHTML = '';

    Object.entries(productInventory).forEach(([name, data]) => {
      const sold = data.quantity;
      const stock = productStock[name] ?? 0;
      const remaining = stock - sold;

      const badge = remaining <= 5
        ? `<span class="badge bg-red-100 text-red-700 ml-2">Low Stock</span>`
        : '';

      const img = data.image
        ? `<img src="${data.image}" class="w-20 h-20 object-contain rounded-xl border border-pink-200 shadow-sm" alt="${name}" />`
        : `<div class="w-20 h-20 bg-gray-200 rounded-xl flex items-center justify-center text-gray-500 text-xs">No Image</div>`;

      const div = document.createElement('div');
      div.className = 'glass product-card rounded-xl p-4 flex items-center gap-4';

      div.innerHTML = `
        ${img}
        <div class="flex-1">
          <p class="font-bold text-gray-800">${name}</p>
          <p class="text-sm text-gray-600 mt-1">Sold: <span class="font-semibold text-pink-600">${sold}</span></p>
          ${badge}
        </div>
      `;
      inventoryContainer.appendChild(div);
    });

    const ctx = document.getElementById('salesChart').getContext('2d');
    if (window.analyticsChart) window.analyticsChart.destroy();
    window.analyticsChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: chartLabels,
        datasets: [{
          label: 'üõçÔ∏è Orders (Ksh)',
          data: chartData,
          backgroundColor: 'rgba(236, 72, 153, 0.6)',
          borderColor: '#ec4899',
          borderWidth: 2,
          borderRadius: 8,
          hoverBackgroundColor: 'rgba(236, 72, 153, 0.8)',
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: true,
            labels: {
              font: {
                family: 'Inter',
                size: 14,
                weight: '600'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(255, 255, 255, 0.95)',
            titleColor: '#1f2937',
            bodyColor: '#4b5563',
            borderColor: '#ec4899',
            borderWidth: 2,
            padding: 12,
            displayColors: false,
            callbacks: {
              label: function (context) {
                const i = context.dataIndex;
                const info = chartInfo[i];
                return `${info.name}: Ksh${info.price}`;
              }
            }
          }
        },
        scales: {
          y: { 
            beginAtZero: true, 
            title: { 
              display: true, 
              text: 'Amount (Ksh)',
              font: {
                family: 'Inter',
                size: 14,
                weight: '600'
              }
            },
            grid: {
              color: 'rgba(236, 72, 153, 0.1)'
            }
          },
          x: { 
            title: { 
              display: true, 
              text: 'Time',
              font: {
                family: 'Inter',
                size: 14,
                weight: '600'
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });

  } catch (err) {
    console.error("Analytics Error:", err);
    alert("‚ùå Failed to load analytics.");
  }
}

// Removed duplicate handleNav - now defined at the top of the script

function filterUsers() {
  const term = document.getElementById("userSearchInput").value.toLowerCase();
  const filtered = allUsers.filter(user =>
    user.name.toLowerCase().includes(term) ||
    user.email.toLowerCase().includes(term)
  );
  renderUsers(filtered);
}
</script>

<script>
  setInterval(() => {
    console.clear();
  }, 100);

  (function() {
    const devtools = /./;
    devtools.toString = function() {
      console.clear();
      console.log("DevTools detection activated!");
      return "";
    };
    console.log("%c", devtools);
  })();
</script>

<script>
  (function() {
     document.addEventListener("contextmenu", function(event) {
       event.preventDefault();
     });

     document.addEventListener("keydown", function(event) {
       if (event.keyCode == 123) {
         event.preventDefault();
       }
       if (event.ctrlKey && event.shiftKey && (event.keyCode == 73 || event.keyCode == 74)) {
         event.preventDefault();
       }
       if (event.ctrlKey && event.keyCode == 85) {
         event.preventDefault();
       }
     });

     function detectDevTools() {
       let devtoolsOpen = false;

       const before = new Date();
       debugger;
       const after = new Date();

       if (after - before > 100) {
         devtoolsOpen = true;
       }

       if (devtoolsOpen) {
         document.body.innerHTML = `<div style="text-align:center; font-size:24px; font-weight:bold; color:red; margin-top:50px;">
           üö® ERROR: DevTools Detected! Please close DevTools to access this website. üö®
         </div>`;
       }
     }

     setInterval(detectDevTools, 1000);
     
     document.querySelectorAll("input, textarea").forEach((element) => {
       element.addEventListener("input", function() {
         this.value = this.value.replace(/</g, "&lt;").replace(/>/g, "&gt;");
       });
     });

     async function detectVPN() {
       try {
         const response = await fetch("https://vpnapi.io/api/?key=564239f58fd7438d8cbbbb1c0960ff07");
         const data = await response.json();

         if (data.security.vpn || data.security.proxy || data.security.tor) {
           document.body.innerHTML = `<div style="text-align:center; font-size:24px; font-weight:bold; color:red; margin-top:50px;">
             üö® ERROR: VPN/Proxy Detected! Please disable VPN to access this website. üö®
           </div>`;
         }
       } catch (error) {
         console.log("VPN detection error:", error);
       }
     }

     detectVPN();

   })();
 </script>

<!-- Footer -->
<footer class="bg-gradient-to-r from-pink-50 via-white to-pink-50 text-gray-800 py-16 relative overflow-hidden">
  <!-- Subtle background pattern -->
  <div class="absolute inset-0 opacity-5">
    <div class="absolute top-10 left-10 w-20 h-20 border border-pink-300 rounded-full"></div>
    <div class="absolute bottom-10 right-10 w-16 h-16 border border-pink-400 rounded-full"></div>
    <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-pink-200 rounded-full opacity-30"></div>
  </div>

  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <!-- Brand Section -->
      <div class="col-span-1 md:col-span-2">
        <div class="flex items-center space-x-3 mb-6">
          <img src="https://i.imgur.com/NvQLami.png" alt="lukumisteress Logo" class="w-16 h-16 object-contain drop-shadow-lg" />
          <div>
            <h3 class="text-2xl font-bold bg-gradient-to-r from-pink-500 to-rose-500 bg-clip-text text-transparent">lukumisteress</h3>
            <p class="text-sm text-pink-400 font-medium">Step into Style</p>
          </div>
        </div>
        <p class="text-gray-600 mb-6 leading-relaxed">
          Kenya's premier affordable online shoe store for all genders. Discover quality sneakers, heels, sandals, boots, and more at unbeatable prices. Walk with confidence, step with style.
        </p>
        <div class="flex space-x-4">
          <!-- Facebook -->
          <a href="#" class="w-12 h-12 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            <span class="text-white text-xl font-bold">f</span>
          </a>
          <!-- Instagram -->
          <a href="#" class="w-12 h-12 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 hover:from-pink-600 hover:via-red-600 hover:to-yellow-600 rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl transform hover:-translate-y-1 relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-r from-purple-600 to-pink-600 opacity-0 hover:opacity-20 transition-opacity duration-300"></div>
            <span class="text-white text-xl relative z-10">üì∑</span>
          </a>
          <!-- Twitter -->
          <a href="#" class="w-12 h-12 bg-gradient-to-r from-blue-400 to-blue-500 hover:from-blue-500 hover:to-blue-600 rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            <span class="text-white text-xl">üê¶</span>
          </a>
          <!-- TikTok -->
          <a href="#" class="w-12 h-12 bg-gradient-to-r from-black to-gray-800 hover:from-gray-800 hover:to-black rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl transform hover:-translate-y-1 relative">
            <div class="absolute inset-0 bg-gradient-to-r from-pink-500 to-cyan-500 opacity-0 hover:opacity-30 transition-opacity duration-300 rounded-full"></div>
            <span class="text-white text-xl relative z-10 font-bold">T</span>
          </a>
          <!-- WhatsApp -->
          <a href="#" class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
            <span class="text-white text-xl">üí¨</span>
          </a>
        </div>
      </div>

      <!-- Quick Links -->
      <div>
        <h4 class="text-lg font-semibold mb-6 text-pink-500">Shop Categories</h4>
        <ul class="space-y-3">
          <li><a href="../category?name=sandals" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üë°</span>Sandals
          </a></li>
          <li><a href="../category?name=wedges" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üë†</span>Wedges
          </a></li>
          <li><a href="../category?name=slides" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">ü•ø</span>Slides
          </a></li>
          <li><a href="../category?name=sneakers" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üëü</span>Sneakers
          </a></li>
          <li><a href="../category?name=rubbers" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üë¢</span>Rubbers
          </a></li>
        </ul>
      </div>

      <!-- Policies -->
      <div>
        <h4 class="text-lg font-semibold mb-6 text-pink-500">Legal & Support</h4>
        <ul class="space-y-3">
          <li><a href="../terms.html" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üìã</span>Terms of Service
          </a></li>
          <li><a href="../privacy.html" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üîí</span>Privacy Policy
          </a></li>
          <li><a href="../refund.html" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">‚Ü©Ô∏è</span>Refund Policy
          </a></li>
          <li><a href="../shipping.html" class="text-gray-600 hover:text-pink-600 transition-all duration-300 flex items-center group">
            <span class="mr-2 opacity-0 group-hover:opacity-100 transition-opacity">üöö</span>Shipping Policy
          </a></li>
        </ul>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="border-t border-pink-200 mt-12 pt-8">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <p class="text-gray-500 text-sm mb-4 md:mb-0">
          &copy; 2025 lukumisteress. Crafted with ‚ù§Ô∏è in Nairobi, Kenya.
        </p>
        <div class="flex items-center space-x-6">
          <a href="mailto:support@lukumisteress.com" class="text-gray-500 hover:text-pink-500 transition-all duration-300 flex items-center">
            <span class="mr-2">üìß</span>support@lukumisteress.com
          </a>
          <span class="text-pink-300">|</span>
          <span class="text-gray-500 flex items-center">
            <span class="mr-2">üìç</span>Nairobi, Kenya
          </span>
        </div>
      </div>
    </div>
  </div>
</footer>
</body>
</html>